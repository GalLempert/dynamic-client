<div class="h-screen flex flex-col bg-gray-50">

  <!-- Top Bar -->
  <header class="bg-gray-800 text-white p-3 flex justify-between items-center shadow-md">
    <div class="flex items-center gap-4">
        <a routerLink="/" class="text-xl font-bold hover:text-gray-300 transition">DynamicClient</a>
        <span class="text-xs bg-gray-700 px-2 py-0.5 rounded border border-gray-600">{{ env }}</span>
        <span class="text-gray-400">|</span>
        <span class="font-semibold text-gray-300">{{ resourceType }}</span>
        <span class="text-gray-500">/</span>
        <span class="font-bold">{{ data?.name || data?.storeName || id }}</span>
    </div>

    <div class="flex-grow max-w-md mx-4">
        <input placeholder="Jump to resource..." class="input bg-gray-700 text-white border-gray-600 focus:bg-gray-600 placeholder-gray-400">
    </div>

    <div class="flex gap-2">
         <button *ngIf="!isEditing" (click)="toggleEdit()" class="btn btn-primary">Edit</button>
         <button *ngIf="!isEditing" (click)="deleteResource()" class="btn btn-danger">Delete</button>

         <button *ngIf="isEditing" (click)="triggerSave()" class="btn btn-success">Save</button>
         <button *ngIf="isEditing" (click)="cancel()" class="btn btn-secondary">Cancel</button>
    </div>
  </header>

  <!-- Content Split -->
  <main class="flex-grow flex overflow-hidden">
    <!-- Left: Map -->
    <div class="w-1/2 relative border-r border-gray-200">
        <app-map *ngIf="data" [location]="data.location" [name]="data.name || data.storeName"></app-map>
        <div *ngIf="!data" class="h-full flex items-center justify-center text-gray-400">Loading map...</div>
    </div>

    <!-- Right: Form -->
    <div class="w-1/2 overflow-auto bg-white p-8">
        <div *ngIf="data && resourceDef" class="max-w-xl mx-auto">
            <h2 class="text-2xl mb-6 border-b pb-2 text-gray-800">
                {{ isEditing ? 'Edit Resource' : 'Resource Details' }}
            </h2>
            <app-dynamic-form
                [schema]="resourceDef.schema"
                [data]="data"
                [isEditing]="isEditing"
                (save)="onSaveData($event)">
            </app-dynamic-form>
        </div>
        <div *ngIf="!data" class="text-center mt-10 text-gray-500">Loading details...</div>
    </div>
  </main>
</div>
